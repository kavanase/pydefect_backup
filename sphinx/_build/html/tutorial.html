
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Simple tutorial of pydefect &#8212; pydefect beta documentation</title>
    <link rel="stylesheet" href="_static/corlab.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="index.html">pydefect beta documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="simple-tutorial-of-pydefect">
<h1>Simple tutorial of pydefect<a class="headerlink" href="#simple-tutorial-of-pydefect" title="Permalink to this headline">¶</a></h1>
<hr class="docutils" />
<p>This web page illustrates how to use the PyDefect code.</p>
<p>Usually, point-defect calculations are complicated following the flow below.</p>
<p><img alt="_images/flowchart.png" src="_images/flowchart.png" /></p>
<p>As shown, some tasks are performed concurrently.</p>
<p>Here, we suppose the following directory tree.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    &lt;project_name&gt;
     │
     ├ unitcell/ ── structure_opt/
     │            ├ band/
     │            └ dos/
     │            
     ├ competing_phases/ ── &lt;competing_phase 1&gt;
     │                    ├ &lt;competing_phase 2&gt;
     │                    ....
     │  
     └ defects/ ── perfect/  
                 ├ Va_X_0/
                 ├ Va_X_1/
                 ├ Va_X_2/
                 ...
</pre></div>
</div>
<p>Details of the process are examined step by step.
Units in PyDefect package are eV and Angstrom for energy and length.</p>
<div class="section" id="relaxation-of-unit-cell">
<h2>1. Relaxation of unit cell<a class="headerlink" href="#relaxation-of-unit-cell" title="Permalink to this headline">¶</a></h2>
<p>The point defect calculations need to be generally performed at a fully relaxed theoretical structures,
including both lattice constants and fractional coordinates of atomic positions.
Therefore, one begins with fully relaxing the unit cell.</p>
<p>First, we need to prepare the POSCAR file of the pristine bulk unitcell.
And, create <code class="docutils literal notranslate"><span class="pre">unitcell/</span></code> directory and <code class="docutils literal notranslate"><span class="pre">structure_opt</span></code> subdirectory under <code class="docutils literal notranslate"><span class="pre">unitcell/</span></code> and move there.
PyDefect can construct the vasp input sets, namely INCAR, POTCAR, KPOINTS, for various tasks related to the point-defect calculations with simple command line tools.
For instance, vasp input set for structure optimization of the unitcell with the PBEsol functional can be generated using the following command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">~/</span><span class="n">my_bin</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="n">vos</span> <span class="o">-</span><span class="n">t</span> <span class="n">structure_opt</span> <span class="o">-</span><span class="n">x</span> <span class="n">pbesol</span>
</pre></div>
</div>
<p>vos, meaning an abbreviation for vasp_oba_set, is a subparse option.
VaspObaSet is a program that create vasp input files, analyze and visualize vasp output files.
It is written on the basis of <a class="reference external" href="http://pymatgen.org">pymatgen</a>, a robust, open-source Python library for materials analysis.
Please also refer the document for VaspObaSet.</p>
<p>There are many options, so please refer the help of the sub command by</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">~/</span><span class="n">my_bin</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="n">vos</span> <span class="o">-</span><span class="n">h</span>
</pre></div>
</div>
</div>
<div class="section" id="calculation-of-band-dos-and-dielectric-tensor">
<h2>2. Calculation of band, DOS, and dielectric tensor<a class="headerlink" href="#calculation-of-band-dos-and-dielectric-tensor" title="Permalink to this headline">¶</a></h2>
<p>We then calculate the electronic structure, namely band structure, density of states, and dielectric constant.
In the defect calculations, we can determine the valence band maximum (VBM) and
conduction band minimum (CBM) from the band structure and DOS.</p>
<p>First, make <code class="docutils literal notranslate"><span class="pre">band/</span></code>, <code class="docutils literal notranslate"><span class="pre">dos/</span></code> and <code class="docutils literal notranslate"><span class="pre">dielectric/</span></code> directories under <code class="docutils literal notranslate"><span class="pre">unitcell/</span></code>.
And then move to each directory and type the following command, respectively.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">~/</span><span class="n">my_bin</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="n">vos</span> <span class="o">-</span><span class="n">t</span> <span class="n">band</span> <span class="o">-</span><span class="n">x</span> <span class="n">pbesol</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">~/</span><span class="n">my_bin</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="n">vos</span> <span class="o">-</span><span class="n">t</span> <span class="n">dos</span> <span class="o">-</span><span class="n">x</span> <span class="n">pbesol</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">~/</span><span class="n">my_bin</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="n">vos</span> <span class="o">-</span><span class="n">t</span> <span class="n">dielectric</span> <span class="o">-</span><span class="n">x</span> <span class="n">pbesol</span>
</pre></div>
</div>
<p>After finishing the vasp calculations, type</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">~/</span><span class="n">my_bin</span><span class="o">/</span><span class="n">phos_pbesol</span><span class="o">/</span><span class="n">obadb</span><span class="o">/</span><span class="n">obadb</span><span class="o">/</span><span class="n">analyzer</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="n">pb</span> <span class="o">-</span><span class="n">v</span> <span class="n">vasprun</span><span class="o">.</span><span class="n">xml</span> <span class="o">-</span><span class="n">k</span> <span class="n">KPOINTS</span> <span class="o">-</span><span class="n">f</span> <span class="n">band</span><span class="o">.</span><span class="n">pdf</span>
</pre></div>
</div>
<p>and</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">~/</span><span class="n">my_bin</span><span class="o">/</span><span class="n">phos_pbesol</span><span class="o">/</span><span class="n">obadb</span><span class="o">/</span><span class="n">obadb</span><span class="o">/</span><span class="n">analyzer</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="n">pd</span> <span class="o">-</span><span class="n">v</span> <span class="n">vasprun</span><span class="o">.</span><span class="n">xml</span> <span class="o">-</span><span class="n">f</span> <span class="n">dos</span><span class="o">.</span><span class="n">pdf</span>
</pre></div>
</div>
<p>for making the plot of the band structure and DOS.</p>
<p>Here, the band path is determined based upon the <a class="reference external" href="https://www.materialscloud.org/work/tools/seekpath">seekpath code</a>,
so if one uses the plot, please cite the following paper.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S0927025616305110?via%3Dihub">Y. Hinuma, G. Pizzi, Y. Kumagai, F. Oba, I. Tanaka, Band structure diagram paths based on crystallography, Comp. Mat. Sci. 128, 140 (2017).</a>
DOI: 10.1016/j.commatsci.2016.10.015 (the “HPKOT” paper; arXiv version: arXiv:1602.06402).</p></li>
</ul>
</div>
<div class="section" id="gathering-unitcell-information-related-to-point-defect-calculations">
<h2>3. Gathering unitcell information related to point-defect calculations<a class="headerlink" href="#gathering-unitcell-information-related-to-point-defect-calculations" title="Permalink to this headline">¶</a></h2>
<p>At this point, we can collect the unitcell information that is essential for analyzing point-defect calculations,
namely band edges, electronic and ionic contributions to dielectric tensor, unitcell volume, and unitcell DOS,
using the unitcell_results or ur subparse option.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">~/</span><span class="n">my_bin</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="n">ur</span> <span class="o">--</span><span class="n">static_diele_dir</span> <span class="n">dielectric</span> <span class="o">--</span><span class="n">ionic_diele_dir</span> <span class="n">dielectric</span> <span class="o">--</span><span class="n">band_edge_dir</span> <span class="n">band</span> <span class="o">--</span><span class="n">volume_dir</span> <span class="n">dielectric</span> <span class="o">--</span><span class="n">total_dos_dir</span> <span class="n">dos</span> <span class="o">--</span><span class="n">json_file</span> <span class="n">unitcell</span><span class="o">.</span><span class="n">json</span> <span class="o">-</span><span class="n">o</span> <span class="n">OUTCAR</span> <span class="o">-</span><span class="n">p</span> <span class="n">CONTCAR</span> <span class="o">-</span><span class="n">v</span> <span class="n">vasprun</span><span class="o">.</span><span class="n">xml</span>
</pre></div>
</div>
<p>Then, unitcell.json is generated.
One can see the information with the command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">~/</span><span class="n">my_bin</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="n">ur</span> <span class="o">--</span><span class="nb">print</span>
</pre></div>
</div>
<p>which shows as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vbm</span> <span class="p">(</span><span class="n">eV</span><span class="p">):</span> <span class="mf">3.4103</span>
<span class="n">cbm</span> <span class="p">(</span><span class="n">eV</span><span class="p">):</span> <span class="mf">4.4278</span>
<span class="n">static</span> <span class="n">dielectric</span> <span class="n">tensor</span><span class="p">:</span>
<span class="p">[[</span> <span class="mf">4.680097</span> <span class="o">-</span><span class="mf">0.</span>       <span class="o">-</span><span class="mf">0.</span>      <span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.</span>        <span class="mf">4.680097</span>  <span class="mf">0.</span>      <span class="p">]</span>
 <span class="p">[</span> <span class="mf">0.</span>       <span class="o">-</span><span class="mf">0.</span>        <span class="mf">4.680097</span><span class="p">]]</span>
<span class="n">ionic</span> <span class="n">dielectric</span> <span class="n">tensor</span><span class="p">:</span>
<span class="p">[[</span><span class="mf">14.953044</span> <span class="o">-</span><span class="mf">0.</span>        <span class="mf">0.</span>      <span class="p">]</span>
 <span class="p">[</span><span class="o">-</span><span class="mf">0.</span>       <span class="mf">14.953065</span> <span class="o">-</span><span class="mf">0.</span>      <span class="p">]</span>
 <span class="p">[</span> <span class="mf">0.</span>       <span class="o">-</span><span class="mf">0.</span>       <span class="mf">14.953038</span><span class="p">]]</span>
<span class="n">total</span> <span class="n">dielectric</span> <span class="n">tensor</span><span class="p">:</span>
<span class="p">[[</span><span class="mf">19.633141000000002</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">19.633162</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">19.633135</span><span class="p">]]</span>
<span class="n">volume</span> <span class="p">(</span><span class="n">A</span><span class="o">^</span><span class="mi">3</span><span class="p">):</span> <span class="mf">68.98647886527607</span>
<span class="n">Total</span> <span class="n">DOS</span><span class="p">:</span> <span class="n">Exists</span>
</pre></div>
</div>
</div>
<div class="section" id="calculation-of-competing-phases">
<h2>4. Calculation of competing phases<a class="headerlink" href="#calculation-of-competing-phases" title="Permalink to this headline">¶</a></h2>
<p>We then calculate the competing phases.</p>
<p>First, we create <code class="docutils literal notranslate"><span class="pre">competing_phases</span></code> and move there.
We then create directories for competing phases including VASP input sets.
By using the chempotdiag program developed and managed by Akira Takahashi, we can obtain POSCARs of the stable or slightly unstable competing phases.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">~/</span><span class="n">my_bin</span><span class="o">/</span><span class="n">phos_pbesol</span><span class="o">/</span><span class="n">obadb</span><span class="o">/</span><span class="n">obadb</span><span class="o">/</span><span class="n">analyzer</span><span class="o">/</span><span class="n">chempotdiag</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="n">cpd</span> <span class="o">-</span><span class="n">m</span> <span class="o">-</span><span class="n">el</span> <span class="n">Ba</span> <span class="n">Sn</span> <span class="n">O</span> <span class="o">-</span><span class="n">ch</span> <span class="mf">0.05</span>
</pre></div>
</div>
<p>In this case, the materials of which energy above hull is less than 0.5 meV/atom are collected.</p>
<p>We then generate the other input files.
In order to fix the cutoff energy at 1.3 x maximum of the <code class="docutils literal notranslate"><span class="pre">ENMAX</span></code> for all the elements, we set <code class="docutils literal notranslate"><span class="pre">ENCUT</span> <span class="pre">=</span> <span class="pre">520</span></code>,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">~/</span><span class="n">my_bin</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="n">vos</span> <span class="o">-</span><span class="n">t</span> <span class="n">structure_opt</span> <span class="o">-</span><span class="n">x</span> <span class="n">pbesol</span> <span class="o">-</span><span class="ow">is</span> <span class="n">ENCUT</span> <span class="mi">520</span> <span class="o">--</span><span class="n">dirs</span> <span class="o">*</span><span class="n">_</span><span class="o">*/</span>
</pre></div>
</div>
<p>Note, if competing phases are gases, we need to change the ISIF to 2 to fix the lattice constants.
In such case, like N2molecule_pydefect, type as follows,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">~/</span><span class="n">my_bin</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="n">vos</span> <span class="o">-</span><span class="n">t</span> <span class="n">structure_opt</span> <span class="o">-</span><span class="n">x</span> <span class="n">pbesol</span> <span class="o">-</span><span class="ow">is</span> <span class="n">ENCUT</span> <span class="mi">520</span> <span class="n">ISIF</span> <span class="mi">2</span> <span class="o">--</span><span class="n">dirs</span> <span class="n">O2molecule_pydefect</span>
</pre></div>
</div>
<p>After finishing the vasp calculations, we generate the chemical potential diagram.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">~/</span><span class="n">my_bin</span><span class="o">/</span><span class="n">phos_pbesol</span><span class="o">/</span><span class="n">obadb</span><span class="o">/</span><span class="n">obadb</span><span class="o">/</span><span class="n">analyzer</span><span class="o">/</span><span class="n">chempotdiag</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="n">cpd</span> <span class="o">-</span><span class="n">v</span> <span class="o">*/</span> <span class="o">-</span><span class="n">p</span> <span class="n">POSCAR</span><span class="o">-</span><span class="n">finish</span> <span class="o">-</span><span class="n">o</span> <span class="n">OUTCAR</span><span class="o">-</span><span class="n">finish</span> <span class="o">-</span><span class="n">c</span> <span class="n">BaSnO3</span> <span class="o">-</span><span class="n">y</span> <span class="o">-</span><span class="n">s</span> <span class="n">cpd_BaSnO3</span><span class="o">.</span><span class="n">pdf</span>
</pre></div>
</div>
<p>Note that there are some parameters for gas phases, so read help for more details.
In such a case, we obtain the cpd_BaSnO3.pdf</p>
<p><img alt="_images/cpd_BaSnO3.png" src="_images/cpd_BaSnO3.png" />cpd_BaSnO3.png</p>
<p>and values at the vertices in the chemical potential diagram (vertices_BaSnO3.yaml)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">:</span> <span class="p">{</span><span class="n">Ba</span><span class="p">:</span> <span class="o">-</span><span class="mf">6.339048510000005</span><span class="p">,</span> <span class="n">O</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.18899787319844918</span><span class="p">,</span> <span class="n">Sn</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.638818995000001</span><span class="p">}</span>
<span class="n">B</span><span class="p">:</span> <span class="p">{</span><span class="n">Ba</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.9688971474999875</span><span class="p">,</span> <span class="n">O</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.22601300944845448</span><span class="p">,</span> <span class="n">Sn</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.897924948750013</span><span class="p">}</span>
<span class="n">C</span><span class="p">:</span> <span class="p">{</span><span class="n">Ba</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.257239969999993</span><span class="p">,</span> <span class="n">O</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.5818415981984444</span><span class="p">,</span> <span class="n">Sn</span><span class="p">:</span> <span class="o">-</span><span class="mf">5.542096360000016</span><span class="p">}</span>
<span class="n">D</span><span class="p">:</span> <span class="p">{</span><span class="n">Ba</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.4861917899999817</span><span class="p">,</span> <span class="n">O</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.3528897781984526</span><span class="p">,</span> <span class="n">Sn</span><span class="p">:</span> <span class="mf">3.552713678800501e-15</span><span class="p">}</span>
<span class="n">E</span><span class="p">:</span> <span class="p">{</span><span class="n">Ba</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.2221928749999975</span><span class="p">,</span> <span class="n">O</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.1075560831984568</span><span class="p">,</span> <span class="n">Sn</span><span class="p">:</span> <span class="mf">3.552713678800501e-15</span><span class="p">}</span>
<span class="n">F</span><span class="p">:</span> <span class="p">{</span><span class="n">Ba</span><span class="p">:</span> <span class="o">-</span><span class="mf">3.6187877250000113</span><span class="p">,</span> <span class="n">O</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.9092586581984463</span><span class="p">,</span> <span class="n">Sn</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.19829742500001046</span><span class="p">}</span>
<span class="n">compound</span><span class="p">:</span> <span class="n">BaSnO3</span>
<span class="n">pressure</span><span class="p">:</span> <span class="n">null</span>
<span class="n">standard_energy</span><span class="p">:</span> <span class="p">{</span><span class="n">Ba</span><span class="p">:</span> <span class="o">-</span><span class="mf">2.141765</span><span class="p">,</span> <span class="n">O</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.872655801801549</span><span class="p">,</span> <span class="n">Sn</span><span class="p">:</span> <span class="o">-</span><span class="mf">4.1937075</span><span class="p">}</span>
<span class="n">temperature</span><span class="p">:</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">standard_energy</span></code> is the energy of simple substances or simple gas phases.
And, A–F show the relative values.</p>
<p>The yaml file will be used for plotting the defect formation energies.</p>
</div>
<div class="section" id="select-of-a-supercell">
<h2>5. Select of a supercell<a class="headerlink" href="#select-of-a-supercell" title="Permalink to this headline">¶</a></h2>
<p>So far, we have finished the calculations of the unit cell and competing phases,
and now are ready for point defect calculations.
Let’s create <code class="docutils literal notranslate"><span class="pre">defect/</span></code> directory and copy unitcell POSCAR file from <code class="docutils literal notranslate"><span class="pre">unitcell/dos/</span></code> to <code class="docutils literal notranslate"><span class="pre">defect/</span></code></p>
<p>Firstly, we need to determine the shape and size of the supercell.
PyDefect recommends a nearly isotropic supercell composed of moderate number of atoms.
For this purpose, use <code class="docutils literal notranslate"><span class="pre">recommend_supercell</span></code> or <code class="docutils literal notranslate"><span class="pre">rs</span></code> subparse</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">~/</span><span class="n">my_bin</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="n">rs</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">UPOSCAR</span></code> and <code class="docutils literal notranslate"><span class="pre">SPOSCAR</span></code> are the POSCARs for the unitcell and the supercell.</p>
</div>
<div class="section" id="construction-of-defect-initial-setting">
<h2>6. Construction of defect initial setting<a class="headerlink" href="#construction-of-defect-initial-setting" title="Permalink to this headline">¶</a></h2>
<p>We then generate the defect initial setting file by typing</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">~/</span><span class="n">my_bin</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="ow">is</span>
</pre></div>
</div>
<p>With this command, we can build the <code class="docutils literal notranslate"><span class="pre">defect.in</span></code> file, which contains the information on what kind of defects are to be generated,
as well as the DPOSCAR.
If you follow this tutorial, DPOSCAR file is the same as SPOSCAR.</p>
<p>An example of <code class="docutils literal notranslate"><span class="pre">defect.in</span></code> is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">Space</span> <span class="n">group</span><span class="p">:</span> <span class="n">Pm</span><span class="o">-</span><span class="mi">3</span><span class="n">m</span>

<span class="n">Transformation</span> <span class="n">matrix</span><span class="p">:</span>  <span class="mi">3</span>  <span class="mi">3</span>  <span class="mi">3</span>
<span class="n">Cell</span> <span class="n">multiplicity</span><span class="p">:</span> <span class="mi">27</span>

   <span class="n">Irreducible</span> <span class="n">element</span><span class="p">:</span> <span class="n">Ba1</span>
        <span class="n">Wyckoff</span> <span class="n">letter</span><span class="p">:</span> <span class="n">a</span>
         <span class="n">Site</span> <span class="n">symmetry</span><span class="p">:</span> <span class="n">m</span><span class="o">-</span><span class="mi">3</span><span class="n">m</span>
          <span class="n">Coordination</span><span class="p">:</span> <span class="n">O2</span><span class="o">-</span><span class="p">:</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> 
      <span class="n">Equivalent</span> <span class="n">atoms</span><span class="p">:</span> <span class="mf">1.</span><span class="o">.</span><span class="mi">27</span>
<span class="n">Fractional</span> <span class="n">coordinates</span><span class="p">:</span> <span class="mf">0.1666670</span>  <span class="mf">0.1666670</span>  <span class="mf">0.1666670</span>
     <span class="n">Electronegativity</span><span class="p">:</span> <span class="mf">0.89</span>
       <span class="n">Oxidation</span> <span class="n">state</span><span class="p">:</span> <span class="mi">2</span>

   <span class="n">Irreducible</span> <span class="n">element</span><span class="p">:</span> <span class="n">Sn1</span>
        <span class="n">Wyckoff</span> <span class="n">letter</span><span class="p">:</span> <span class="n">b</span>
         <span class="n">Site</span> <span class="n">symmetry</span><span class="p">:</span> <span class="n">m</span><span class="o">-</span><span class="mi">3</span><span class="n">m</span>
          <span class="n">Coordination</span><span class="p">:</span> <span class="n">O2</span><span class="o">-</span><span class="p">:</span> <span class="mf">2.05</span> <span class="mf">2.05</span> <span class="mf">2.05</span> <span class="mf">2.05</span> <span class="mf">2.05</span> <span class="mf">2.05</span> 
      <span class="n">Equivalent</span> <span class="n">atoms</span><span class="p">:</span> <span class="mf">28.</span><span class="o">.</span><span class="mi">54</span>
<span class="n">Fractional</span> <span class="n">coordinates</span><span class="p">:</span> <span class="mf">0.0000000</span>  <span class="mf">0.0000000</span>  <span class="mf">0.0000000</span>
     <span class="n">Electronegativity</span><span class="p">:</span> <span class="mf">1.96</span>
       <span class="n">Oxidation</span> <span class="n">state</span><span class="p">:</span> <span class="mi">4</span>
       
   <span class="n">Irreducible</span> <span class="n">element</span><span class="p">:</span> <span class="n">O1</span>
        <span class="n">Wyckoff</span> <span class="n">letter</span><span class="p">:</span> <span class="n">c</span>
         <span class="n">Site</span> <span class="n">symmetry</span><span class="p">:</span> <span class="mi">4</span><span class="o">/</span><span class="n">mmm</span>
          <span class="n">Coordination</span><span class="p">:</span> <span class="n">Ba2</span><span class="o">+</span><span class="p">:</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="n">Sn4</span><span class="o">+</span><span class="p">:</span> <span class="mf">2.05</span> <span class="mf">2.05</span> <span class="n">O2</span><span class="o">-</span><span class="p">:</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> 
      <span class="n">Equivalent</span> <span class="n">atoms</span><span class="p">:</span> <span class="mf">55.</span><span class="o">.</span><span class="mi">135</span>
<span class="n">Fractional</span> <span class="n">coordinates</span><span class="p">:</span> <span class="mf">0.0000000</span>  <span class="mf">0.1666670</span>  <span class="mf">0.0000000</span>
     <span class="n">Electronegativity</span><span class="p">:</span> <span class="mf">3.44</span>
       <span class="n">Oxidation</span> <span class="n">state</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span>

<span class="n">Interstitials</span><span class="p">:</span> 
<span class="n">Antisite</span> <span class="n">defects</span><span class="p">:</span> 

<span class="n">Substituted</span> <span class="n">defects</span><span class="p">:</span> 

<span class="n">Maximum</span> <span class="n">Displacement</span><span class="p">:</span> <span class="mf">0.2</span>

<span class="n">Exceptionally</span> <span class="n">included</span><span class="p">:</span> 
<span class="n">Exceptionally</span> <span class="n">excluded</span><span class="p">:</span> 

<span class="n">Cutoff</span> <span class="n">region</span> <span class="n">of</span> <span class="n">atoms</span> <span class="n">perturbed</span><span class="p">:</span> <span class="mf">3.0</span>
<span class="n">Symprec</span><span class="p">:</span> <span class="mf">0.01</span>
<span class="n">Angle</span> <span class="n">tolerance</span><span class="p">:</span> <span class="mi">5</span>
</pre></div>
</div>
<p>If you want to add dopants a posteriori, you can type as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">~/</span><span class="n">my_bin</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="ow">is</span> <span class="o">--</span><span class="n">print_dopant</span> <span class="n">Na</span>
</pre></div>
</div>
<p>This example of Na dopant shows</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>   <span class="n">Dopant</span> <span class="n">element</span><span class="p">:</span> <span class="n">Na</span>
<span class="n">Electronegativity</span><span class="p">:</span> <span class="mf">0.93</span>
  <span class="n">Oxidation</span> <span class="n">state</span><span class="p">:</span> <span class="mi">1</span>
</pre></div>
</div>
<p>By inserting this to <code class="docutils literal notranslate"><span class="pre">defect.in</span></code> and modify Substituted defects as follows</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>  <span class="n">Space</span> <span class="n">group</span><span class="p">:</span> <span class="n">Pm</span><span class="o">-</span><span class="mi">3</span><span class="n">m</span>

<span class="n">Transformation</span> <span class="n">matrix</span><span class="p">:</span>  <span class="mi">3</span>  <span class="mi">3</span>  <span class="mi">3</span>
<span class="n">Cell</span> <span class="n">multiplicity</span><span class="p">:</span> <span class="mi">27</span>

   <span class="n">Irreducible</span> <span class="n">element</span><span class="p">:</span> <span class="n">Ba1</span>
        <span class="n">Wyckoff</span> <span class="n">letter</span><span class="p">:</span> <span class="n">a</span>
         <span class="n">Site</span> <span class="n">symmetry</span><span class="p">:</span> <span class="n">m</span><span class="o">-</span><span class="mi">3</span><span class="n">m</span>
          <span class="n">Coordination</span><span class="p">:</span> <span class="n">O2</span><span class="o">-</span><span class="p">:</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> 
      <span class="n">Equivalent</span> <span class="n">atoms</span><span class="p">:</span> <span class="mf">1.</span><span class="o">.</span><span class="mi">27</span>
<span class="n">Fractional</span> <span class="n">coordinates</span><span class="p">:</span> <span class="mf">0.1666670</span>  <span class="mf">0.1666670</span>  <span class="mf">0.1666670</span>
     <span class="n">Electronegativity</span><span class="p">:</span> <span class="mf">0.89</span>
       <span class="n">Oxidation</span> <span class="n">state</span><span class="p">:</span> <span class="mi">2</span>

   <span class="n">Irreducible</span> <span class="n">element</span><span class="p">:</span> <span class="n">Sn1</span>
        <span class="n">Wyckoff</span> <span class="n">letter</span><span class="p">:</span> <span class="n">b</span>
         <span class="n">Site</span> <span class="n">symmetry</span><span class="p">:</span> <span class="n">m</span><span class="o">-</span><span class="mi">3</span><span class="n">m</span>
          <span class="n">Coordination</span><span class="p">:</span> <span class="n">O2</span><span class="o">-</span><span class="p">:</span> <span class="mf">2.05</span> <span class="mf">2.05</span> <span class="mf">2.05</span> <span class="mf">2.05</span> <span class="mf">2.05</span> <span class="mf">2.05</span> 
      <span class="n">Equivalent</span> <span class="n">atoms</span><span class="p">:</span> <span class="mf">28.</span><span class="o">.</span><span class="mi">54</span>
<span class="n">Fractional</span> <span class="n">coordinates</span><span class="p">:</span> <span class="mf">0.0000000</span>  <span class="mf">0.0000000</span>  <span class="mf">0.0000000</span>
     <span class="n">Electronegativity</span><span class="p">:</span> <span class="mf">1.96</span>
       <span class="n">Oxidation</span> <span class="n">state</span><span class="p">:</span> <span class="mi">4</span>

   <span class="n">Irreducible</span> <span class="n">element</span><span class="p">:</span> <span class="n">O1</span>
        <span class="n">Wyckoff</span> <span class="n">letter</span><span class="p">:</span> <span class="n">c</span>
         <span class="n">Site</span> <span class="n">symmetry</span><span class="p">:</span> <span class="mi">4</span><span class="o">/</span><span class="n">mmm</span>
          <span class="n">Coordination</span><span class="p">:</span> <span class="n">Ba2</span><span class="o">+</span><span class="p">:</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="n">Sn4</span><span class="o">+</span><span class="p">:</span> <span class="mf">2.05</span> <span class="mf">2.05</span> <span class="n">O2</span><span class="o">-</span><span class="p">:</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> <span class="mf">2.9</span> 
      <span class="n">Equivalent</span> <span class="n">atoms</span><span class="p">:</span> <span class="mf">55.</span><span class="o">.</span><span class="mi">135</span>
<span class="n">Fractional</span> <span class="n">coordinates</span><span class="p">:</span> <span class="mf">0.0000000</span>  <span class="mf">0.1666670</span>  <span class="mf">0.0000000</span>
     <span class="n">Electronegativity</span><span class="p">:</span> <span class="mf">3.44</span>
       <span class="n">Oxidation</span> <span class="n">state</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span>

<span class="n">Interstitials</span><span class="p">:</span> 
<span class="n">Antisite</span> <span class="n">defects</span><span class="p">:</span> 

   <span class="n">Dopant</span> <span class="n">element</span><span class="p">:</span> <span class="n">Na</span>
<span class="n">Electronegativity</span><span class="p">:</span> <span class="mf">0.93</span>
  <span class="n">Oxidation</span> <span class="n">state</span><span class="p">:</span> <span class="mi">1</span>

<span class="n">Substituted</span> <span class="n">defects</span><span class="p">:</span> <span class="n">Na_Ba</span>

<span class="n">Maximum</span> <span class="n">Displacement</span><span class="p">:</span> <span class="mf">0.2</span>

<span class="n">Exceptionally</span> <span class="n">included</span><span class="p">:</span> 
<span class="n">Exceptionally</span> <span class="n">excluded</span><span class="p">:</span> 

<span class="n">Cutoff</span> <span class="n">region</span> <span class="n">of</span> <span class="n">atoms</span> <span class="n">perturbed</span><span class="p">:</span> <span class="mf">3.0</span>
<span class="n">Symprec</span><span class="p">:</span> <span class="mf">0.01</span>
<span class="n">Angle</span> <span class="n">tolerance</span><span class="p">:</span> <span class="mi">5</span>
</pre></div>
</div>
</div>
<div class="section" id="decision-of-interstitial-sites">
<h2>7. Decision of interstitial sites<a class="headerlink" href="#decision-of-interstitial-sites" title="Permalink to this headline">¶</a></h2>
<p>After constructing an input for standard defect set, one may want to add the interstitial-type defects.
For this purpose, we need to determine the interstitial sites.
Most people determine the interstitial sites by seeing the host crystal structures.
On the contrary, there are a couple of procedures that recommend the interstitial sites.
Still, it is difficult to predict the most likely interstitial sites because they strongly depend on the substituted atoms.
For instance, when positively charged cations with closed shells are substituted (e.g., Mg<sup>2+</sup>, Al<sup>3+</sup>),
the interstitial sites with the largest vacant space should be most likely.
On the other hand, when a proton (H<sup>+</sup>) is inserted, it should prefer to locate near O<sup>2-</sup> or N<sup>3-</sup> to form the strong O-H or N-H bonding.
Therefore, we need to be careful when determining the interstitial sites.</p>
<p>To add the interstitial site, e.g., 0.375 0.375 0.375, we type</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">~/</span><span class="n">my_bin</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="n">i</span> <span class="o">-</span><span class="n">c</span> <span class="mf">0.375</span> <span class="mf">0.375</span> <span class="mf">0.375</span>
</pre></div>
</div>
<p>The interstitials.yaml is then generated, which show various information related to the interstitial sites.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">i1</span><span class="p">:</span>
  <span class="n">representative_coords</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.375</span><span class="p">,</span> <span class="mf">0.375</span><span class="p">,</span> <span class="mf">0.375</span><span class="p">]</span>
  <span class="n">wyckoff</span><span class="p">:</span> <span class="n">a</span>
  <span class="n">site_symmetry</span><span class="p">:</span> <span class="o">-</span><span class="mi">43</span><span class="n">m</span>
  <span class="n">symmetry_multiplicity</span><span class="p">:</span> <span class="mi">64</span>
  <span class="n">coordination_distances</span><span class="p">:</span>
    <span class="n">Mg</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.84</span><span class="p">,</span> <span class="mf">1.84</span><span class="p">,</span> <span class="mf">1.84</span><span class="p">,</span> <span class="mf">1.84</span><span class="p">]</span>
    <span class="n">O</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.84</span><span class="p">,</span> <span class="mf">1.84</span><span class="p">,</span> <span class="mf">1.84</span><span class="p">,</span> <span class="mf">1.84</span><span class="p">,</span> <span class="mf">3.52</span><span class="p">,</span> <span class="mf">3.52</span><span class="p">,</span> <span class="mf">3.52</span><span class="p">,</span> <span class="mf">3.52</span><span class="p">,</span> <span class="mf">3.52</span><span class="p">,</span> <span class="mf">3.52</span><span class="p">,</span> <span class="mf">3.52</span><span class="p">,</span> <span class="mf">3.52</span><span class="p">,</span> <span class="mf">3.52</span><span class="p">,</span>
      <span class="mf">3.52</span><span class="p">,</span> <span class="mf">3.52</span><span class="p">,</span> <span class="mf">3.52</span><span class="p">]</span>
  <span class="n">method</span><span class="p">:</span> <span class="n">manual</span>
</pre></div>
</div>
<p>If you try to add the site that is very close to the constituent atoms or other interstitial sites,
you will get the error message as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Inserted</span> <span class="n">position</span> <span class="ow">is</span> <span class="n">too</span> <span class="n">close</span> <span class="n">to</span> <span class="n">another</span> <span class="n">interstitial</span> <span class="n">site</span><span class="o">.</span>
<span class="n">The</span> <span class="n">distance</span> <span class="ow">is</span> <span class="mf">0.042</span> <span class="n">A</span><span class="o">.</span>
</pre></div>
</div>
<p>If you really want to add the site even in such cases, add –force_add option.</p>
<p>Once you generate the interstitial.yaml, you also need to modify the defect.in file.
When you modify it, add the following line to the defect.in.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Interstitials</span><span class="p">:</span> <span class="n">i1</span>
</pre></div>
</div>
<p>Or you can again type as follows again.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">~/</span><span class="n">my_bin</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">pydefect</span><span class="o">/</span><span class="n">main</span><span class="o">.</span><span class="n">py</span> <span class="ow">is</span> <span class="o">--</span><span class="n">interstitial_sites</span> <span class="n">i1</span>
</pre></div>
</div>
</div>
<div class="section" id="construction-of-defect-calculation-directories">
<h2>8. Construction of defect calculation directories<a class="headerlink" href="#construction-of-defect-calculation-directories" title="Permalink to this headline">¶</a></h2>
<p>After constructing the defect.in file, we</p>
</div>
<div class="section" id="generation-of-supercell-information">
<h2>9. Generation of supercell information<a class="headerlink" href="#generation-of-supercell-information" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="correction-of-defect-formation-energy-in-finite-size-supercell">
<h2>10. Correction of defect formation energy in finite-size supercell<a class="headerlink" href="#correction-of-defect-formation-energy-in-finite-size-supercell" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="check-of-defect-eigenvalues">
<h2>11. Check of defect eigenvalues<a class="headerlink" href="#check-of-defect-eigenvalues" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="plot-of-defect-formation-energies">
<h2>12. Plot of defect formation energies<a class="headerlink" href="#plot-of-defect-formation-energies" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Simple tutorial of pydefect</a><ul>
<li><a class="reference internal" href="#relaxation-of-unit-cell">1. Relaxation of unit cell</a></li>
<li><a class="reference internal" href="#calculation-of-band-dos-and-dielectric-tensor">2. Calculation of band, DOS, and dielectric tensor</a></li>
<li><a class="reference internal" href="#gathering-unitcell-information-related-to-point-defect-calculations">3. Gathering unitcell information related to point-defect calculations</a></li>
<li><a class="reference internal" href="#calculation-of-competing-phases">4. Calculation of competing phases</a></li>
<li><a class="reference internal" href="#select-of-a-supercell">5. Select of a supercell</a></li>
<li><a class="reference internal" href="#construction-of-defect-initial-setting">6. Construction of defect initial setting</a></li>
<li><a class="reference internal" href="#decision-of-interstitial-sites">7. Decision of interstitial sites</a></li>
<li><a class="reference internal" href="#construction-of-defect-calculation-directories">8. Construction of defect calculation directories</a></li>
<li><a class="reference internal" href="#generation-of-supercell-information">9. Generation of supercell information</a></li>
<li><a class="reference internal" href="#correction-of-defect-formation-energy-in-finite-size-supercell">10. Correction of defect formation energy in finite-size supercell</a></li>
<li><a class="reference internal" href="#check-of-defect-eigenvalues">11. Check of defect eigenvalues</a></li>
<li><a class="reference internal" href="#plot-of-defect-formation-energies">12. Plot of defect formation energies</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/tutorial.md.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="index.html">pydefect beta documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Yu Kumagai.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.
    </div>
  </body>
</html>